{% load panels %}
{% load forms %}
<div ng-show="patient == null" class="container-fluid content-offset">
  <h1 class="text-center content-offset">
    Patient not found
  </h1>
  <p class="lead text-center content-offset">
    We're sorry but we couldn't find the patient you're looking for.
    <br />
    Perhaps try searching for them instead?
  </p>
</div>
<div class="entry-tool container-fluid content-offset {% block container_classes %}{% endblock %}"
     ng-hide="patient == null">
  <div class="panel panel-primary panel-container patient-detail {% block panel_classes %}{% endblock %}">
    <!-- Default panel contents -->
    <div class="panel-heading patient-detail-heading">
      <h1>
        {% block heading %}{% icon 'fa-user' %}Patient [[ patient.id ]]{% endblock %}
        <small>
          {% block subheading %}
          <span ng-show="patient.demographics[0].date_of_birth">
            ([[ patient.demographics[0].date_of_birth | displayDate ]])
          </span>
          [[ patient.demographics[0].hospital_number ]]
          {% endblock %}
        </small>
      </h1>
    </div>

    <div class="panel-body {% block panel_body_classes %}{% endblock %}">
      <div class="row">
        {% block content %}
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-12">
                {% include "detail/default.html" %}
              </div>
            </div>
            <div class="row">
              <div ng-controller="LineOfTreatmentCreator as lineOfTreatmentCreator" class="col-md-12">
                <h2>Treatment Lines
                  <a ng-class="{disabled: lineOfTreatmentCreator.loading}" ng-click="!lineOfTreatmentCreator.loading && lineOfTreatmentCreator.create(patient)">
                    <i class="fa fa-plus-circle edit pointer"></i>
                  </a>
                </h2>
              </div>
            </div>
            <div class="row" ng-repeat="episode in patient.episodes | filter: { category_name: 'Treatment Line' } | orderBy: '-id' as lot_episodes">
              <div class="col-md-12">
                {% include "detail/treatmentline.html" %}
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <h2>Follow ups
                  <a ng-click="episode.recordEditor.newItem('{{ models.FollowUp.get_api_name }}')">
                    <i class="fa fa-plus-circle edit pointer"></i>
                  </a>
                </h2>
                {% include "detail/followups.html" %}
              </div>
            </div>
          </div>
        {% endblock content %}
    </div>

  </div> <!-- Panel body -->

</div>   <!-- Panel -->
</div>     <!-- Container -->